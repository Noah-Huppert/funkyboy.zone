// WARNING
//
// Do NOT edit this file while ZNC is running!
// Use webadmin or *controlpanel instead.
//
// Altering this file by hand will forfeit all support.
//
// But if you feel risky, you might want to read help on /znc saveconfig and /znc rehash.
// Also check https://wiki.znc.in/Configuration

Version = 1.7.2

LoadModule = webadmin

ProtectWebSessions = true

SSLCertFile = {{ pillar.znc.directory }}/{{ pillar.znc.pem_file }}
SSLDHParamFile = {{ pillar.znc.directory }}/{{ pillar.znc.pem_file }}
SSLKeyFile = {{ pillar.znc.directory }}/{{ pillar.znc.pem_file }}

<Listener l>
	AllowIRC = true
	AllowWeb = true
	Port = 6697
	IPv4 = true
	IPv6 = true
	SSL = true
</Listener>

{% for user_name, user in pillar['znc']['users'].items() %}
<User {{ user_name }}>
	Admin      = true
	Nick       = {{ user.nick }}
	AltNick    = {{ user.nick }}_alt
	Ident      = {{ user.nick }}
	BindHost   = 127.0.0.1
	LoadModule = chansaver
	LoadModule = controlpanel
	QuitMsg = {{ user.quit_msg }}
	RealName = {{ user.real_name }}

	<Network freenode>
		LoadModule = simple_away
		LoadModule = sasl
		Server     = chat.freenode.net +6697 

		{% for channel in user.channels %}
		<Chan {{ channel }}>
		</Chan>
		{% endfor %}
	</Network>

	<Pass password>
		Hash = {{ user.password.hash }}
		Method = SHA256
		Salt = {{ user.password.salt }}
	</Pass>
</User>
{% endfor %}

// WARNING
//
// Do NOT edit this file while ZNC is running!
// Use webadmin or *controlpanel instead.
//
// Altering this file by hand will forfeit all support.
//
// But if you feel risky, you might want to read help on /znc saveconfig and /znc rehash.
// Also check https://wiki.znc.in/Configuration

AnonIPLimit = 10
AuthOnlyViaModule = false
ConfigWriteDelay = 0
ConnectDelay = 5
HideVersion = false
LoadModule = webadmin
MaxBufferSize = 500
ProtectWebSessions = true
SSLCertFile = /etc/znc/znc.pem
SSLDHParamFile = /etc/znc/znc.pem
SSLKeyFile = /etc/znc/znc.pem
ServerThrottle = 30
Version = 1.7.2

<Listener listener0>
	AllowIRC = true
	AllowWeb = true
	IPv4 = true
	IPv6 = true
	Port = 6697
	SSL = true
	URIPrefix = /
</Listener>

{% for user_name, user in pillar['znc']['users'].items() %}
<User {{ user_name }}>
	Admin      = true
	AltNick    = {{ user.nick }}_alt
	AppendTimestamp = false
	AuthOnlyViaModule = false
	AutoClearChanBuffer = true
	AutoClearQueryBuffer = true
	BindHost   = 127.0.0.1
	ChanBufferSize = 50
	DenyLoadMod = false
	DenySetBindHost = false
	Ident      = {{ user.nick }}
	JoinTries = 10
	LoadModule = chansaver
	LoadModule = controlpanel
	MaxJoins = 0
	MaxNetworks = 1
	MaxQueryBuffers = 50
	MultiClients = true
	Nick       = {{ user.nick }}
	NoTrafficTimeout = 180
	PrependTimestamp = true
	QueryBufferSize = 50
	QuitMsg = {{ user.quit_msg }}
	RealName = {{ user.real_name }}
	StatusPrefix = *
	TimestampFormat = [%H:%M:%S]

	<Network freenode>
		FloodBurst = 9
		FloodRate = 2.00
		IRCConnectEnabled = true
		JoinDelay = 0
		LoadModule = simple_away
		LoadModule = sasl
		Server     = chat.freenode.net +6697 
		TrustAllCerts = false
		TrustPKI = true

		{% for channel in user.channels %}
		<Chan {{ channel }}>
		</Chan>
		{% endfor %}
	</Network>

	<Pass password>
		Hash = {{ user.password.hash }}
		Method = SHA256
		Salt = {{ user.password.salt }}
	</Pass>
</User>
{% endfor %}
